<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sajado – Speisekarte</title>
  <style>
    :root{
      --bg:#ffffff; --text:#111; --muted:#6b7280; --border:#e5e7eb;
      --card:#fff; --shadow:0 6px 22px rgba(0,0,0,.08);
      --radius:18px; --gap:16px; --container:1200px;
      --accent:#b3261e; --accent-weak:#fff1f0;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    html,body{margin:0;background:var(--bg);color:var(--text);
      font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.5}

    /* Header */
    header{position:sticky;top:0;z-index:40;background:var(--bg);border-bottom:1px solid var(--border)}
    .container{max-width:var(--container);margin:0 auto;padding:10px 14px;display:flex;align-items:center;gap:12px}
    .logo{display:flex;align-items:center;gap:12px}
    .logo img{height:56px;width:auto}
    @media (min-width:1100px){ .logo img{height:48px} }
    .logo h1{font-size:clamp(16px,2vw,20px);margin:0;font-weight:800;letter-spacing:.2px}
    .hamburger{width:40px;height:28px;display:flex;flex-direction:column;justify-content:space-between;cursor:pointer}
    .bar{height:3px;border-radius:3px;background:#111}

    main{max-width:var(--container);margin:0 auto;padding:16px}
    section{padding:24px 0;scroll-margin-top:86px}
    h2{margin:0 0 12px;font-size:clamp(18px,2.2vw,24px);font-weight:800;letter-spacing:.2px}

    /* Grid */
    .grid{display:grid;gap:var(--gap);grid-template-columns:repeat(auto-fill,minmax(200px,1fr));align-items:start}
    @media (min-width:620px){ .grid{grid-template-columns:repeat(auto-fill,minmax(240px,1fr))} }
    .card{
      background:var(--card); border:2px solid #f1f1f1; border-radius:var(--radius);
      overflow:hidden; box-shadow:var(--shadow);
      transition:transform .15s ease,box-shadow .15s ease,border-color .15s ease;
      display:flex; align-items:center; justify-content:center; padding:10px;
    }
    .card:hover{transform:translateY(-2px); border-color:var(--accent-weak); box-shadow:0 10px 26px rgba(0,0,0,.1)}
    .card img{display:block; width:100%; height:auto; max-height:420px; object-fit:contain; background:#fff; border-radius:12px}
    @media (min-width:900px){ .card img{max-height:500px} }
    .empty{color:var(--muted); background:#fafafa; border:1px dashed var(--border); border-radius:12px; padding:14px; text-align:center; grid-column:1/-1}

    /* Sidebar */
    .sidebar-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;z-index:30}
    .sidebar{position:fixed;inset:0 auto 0 0;width:330px;max-width:88vw;background:#fff;border-right:1px solid var(--border);
      box-shadow:10px 0 28px rgba(0,0,0,.06);transform:translateX(-100%);transition:transform .22s ease;z-index:50;display:flex;flex-direction:column}
    .sidebar.open{transform:translateX(0)}
    .open-backdrop{display:block}
    .sidebar-header{padding:16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px;
      background:linear-gradient(0deg,#fff 0%,#fff 45%,var(--accent-weak) 45%,var(--accent-weak) 100%)}
    .sidebar-header img{height:38px}
    .sidebar-header .brand{font-weight:800;font-size:16px;letter-spacing:.3px}
    .cat-list{padding:10px;overflow:auto}
    .cat-list a{display:block;padding:14px 14px;margin:6px 0;text-decoration:none;color:#111;border:1px solid var(--border);
      border-radius:12px;background:#fff;transition:background .15s ease,border-color .15s ease,color .15s ease;font-weight:600}
    .cat-list a:hover{background:var(--accent-weak);border-color:#ffd9d6}
    .cat-list a.active{background:var(--accent);color:#fff;border-color:var(--accent)}

    .footer{border-top:1px solid var(--border);padding:22px 16px;text-align:center;color:var(--muted)}

    /* Desktop-Layout: Sidebar sticky */
    @media (min-width:1100px){
      .sidebar{transform:translateX(0);position:sticky;top:0;height:100vh}
      .sidebar-backdrop{display:none!important}
      body{display:grid;grid-template-columns:330px 1fr}
      header{grid-column:1/-1}
      main{padding-left:24px}
      .hamburger{display:none}
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar-backdrop" id="sidebarBackdrop"></div>
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <img src="assets/logo.png" alt="Logo" onerror="this.style.display='none'">
      <div class="brand">Sajado – Kategorien</div>
    </div>
    <nav class="cat-list" id="catList">
      <a href="#vorspeisenappetizers">Vorspeisen/Appetizers</a>
      <a href="#nigiri-sushi">Nigiri-Sushi</a>
      <a href="#single-luxury-plates">Single & Luxury Plates</a>
      <a href="#signature-rolls">Signature Rolls</a>
      <a href="#sashimi">Sashimi</a>
      <a href="#hot-rolls-sushi-burger">Hot Rolls & Sushi Burger</a>
      <a href="#classic-rolls">Classic Rolls</a>
      <a href="#signature-dishes">Signature Dishes</a>
      <a href="#wok">Wok</a>
      <a href="#spicy-korean">Spicy Korean</a>
      <a href="#thai-rotcurrythai-redcurry">Thai Rotcurry/Thai Redcurry</a>
      <a href="#ramenudon">Ramen/Udon</a>
      <a href="#fried-ricenoodles">Fried Rice/Noodles</a>
      <!-- "Beilagen & Saucen" versteckt -->
      <a href="#dessert">Dessert</a>
    </nav>
  </aside>

  <!-- Header -->
  <header>
    <div class="container">
      <div class="hamburger" id="hamburger" aria-label="Menü öffnen" aria-controls="sidebar" aria-expanded="false">
        <div class="bar"></div><div class="bar"></div><div class="bar"></div>
      </div>
      <div class="logo">
        <img src="assets/logo.png" alt="Logo">
        <h1>Sajado – Speisekarte</h1>
      </div>
    </div>
  </header>

  <!-- Content -->
  <main>
    <section id="vorspeisenappetizers"><h2>Vorspeisen/Appetizers</h2><div class="grid" data-category="vorspeisenappetizers"></div></section>
    <section id="nigiri-sushi"><h2>Nigiri-Sushi</h2><div class="grid" data-category="nigiri-sushi"></div></section>
    <section id="single-luxury-plates"><h2>Single & Luxury Plates</h2><div class="grid" data-category="single-luxury-plates"></div></section>
    <section id="signature-rolls"><h2>Signature Rolls</h2><div class="grid" data-category="signature-rolls"></div></section>
    <section id="sashimi"><h2>Sashimi</h2><div class="grid" data-category="sashimi"></div></section>
    <section id="hot-rolls-sushi-burger"><h2>Hot Rolls & Sushi Burger</h2><div class="grid" data-category="hot-rolls-sushi-burger"></div></section>
    <section id="classic-rolls"><h2>Classic Rolls</h2><div class="grid" data-category="classic-rolls"></div></section>
    <section id="signature-dishes"><h2>Signature Dishes</h2><div class="grid" data-category="signature-dishes"></div></section>
    <section id="wok"><h2>Wok</h2><div class="grid" data-category="wok"></div></section>
    <section id="spicy-korean"><h2>Spicy Korean</h2><div class="grid" data-category="spicy-korean"></div></section>
    <section id="thai-rotcurrythai-redcurry"><h2>Thai Rotcurry/Thai Redcurry</h2><div class="grid" data-category="thai-rotcurrythai-redcurry"></div></section>
    <section id="ramenudon"><h2>Ramen/Udon</h2><div class="grid" data-category="ramenudon"></div></section>
    <section id="fried-ricenoodles"><h2>Fried Rice/Noodles</h2><div class="grid" data-category="fried-ricenoodles"></div></section>
    <section id="dessert"><h2>Dessert</h2><div class="grid" data-category="dessert"></div></section>
  </main>

  <div class="footer">© <span id="year"></span> — Alle Rechte vorbehalten.</div>

  <script>
    // Kategorien (ohne Beilagen & Saucen)
    var CATEGORIES = [
      "vorspeisenappetizers","nigiri-sushi","single-luxury-plates","signature-rolls","sashimi",
      "hot-rolls-sushi-burger","classic-rolls","signature-dishes","wok","spicy-korean",
      "thai-rotcurrythai-redcurry","ramenudon","fried-ricenoodles","dessert"
    ];

    function loadManifest(slug){
      var url = "image/" + slug + "/manifest.json";
      return fetch(url, { cache: "no-store" })
        .then(function(res){ if(!res.ok) return null; return res.json(); })
        .then(function(data){ return data && Array.isArray(data.images) ? data.images : null; })
        .catch(function(){ return null; });
    }

    function addCard(grid, src){
      var c = document.createElement("div");
      c.className = "card";
      var img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";
      img.src = src;
      img.alt = "";
      c.appendChild(img);
      grid.appendChild(c);
    }

    function setupSidebarLinks(){
      var links = document.querySelectorAll(".cat-list a");
      for (var i=0;i<links.length;i++){
        (function(a){
          a.addEventListener("click", function(e){
            e.preventDefault();
            var id = a.getAttribute("href").slice(1);
            var target = document.getElementById(id);
            if(target){
              var y = target.getBoundingClientRect().top + window.pageYOffset - 80;
              window.scrollTo({ top: y, behavior: "smooth" });
            }
            closeSidebar();
            for (var j=0;j<links.length;j++) links[j].classList.remove("active");
            a.classList.add("active");
          });
        })(links[i]);
      }
    }

    function observeSections(){
      // Feature detection für IntersectionObserver
      if (!("IntersectionObserver" in window)) return;
      var items = Array.prototype.slice.call(document.querySelectorAll(".cat-list a"));
      var map = {};
      items.forEach(function(a){ map[a.getAttribute("href").slice(1)] = a; });
      var io = new IntersectionObserver(function(entries){
        entries.forEach(function(e){
          if(e.isIntersecting){
            items.forEach(function(i){ i.classList.remove("active"); });
            var link = map[e.target.id];
            if(link) link.classList.add("active");
          }
        });
      }, { rootMargin: "-40% 0px -55% 0px", threshold: 0 });
      var secs = document.querySelectorAll("main > section");
      for (var k=0;k<secs.length;k++) io.observe(secs[k]);
    }

    function init(){
      document.getElementById("year").textContent = new Date().getFullYear();
      // Inhalte füllen
      (function fillAll(idx){
        if (idx >= CATEGORIES.length) { setupSidebarLinks(); observeSections(); return; }
        var slug = CATEGORIES[idx];
        var grid = document.querySelector('.grid[data-category="'+slug+'"]');
        loadManifest(slug).then(function(files){
          if(!files || !files.length){
            grid.innerHTML = '<div class="empty">Keine Bilder gefunden oder manifest.json fehlt.</div>';
          }else{
            for (var i=0;i<files.length;i++){
              addCard(grid, "image/" + slug + "/" + files[i]);
            }
          }
          fillAll(idx+1);
        });
      })(0);
    }

    // Sidebar toggle (ohne optional chaining)
    var sidebar  = document.getElementById('sidebar');
    var backdrop = document.getElementById('sidebarBackdrop');
    var burger   = document.getElementById('hamburger');
    function openSidebar(){ sidebar.classList.add('open'); backdrop.classList.add('open-backdrop'); if (burger) burger.setAttribute('aria-expanded','true'); }
    function closeSidebar(){ sidebar.classList.remove('open'); backdrop.classList.remove('open-backdrop'); if (burger) burger.setAttribute('aria-expanded','false'); }
    if (burger) burger.addEventListener('click', function(){ sidebar.classList.contains('open') ? closeSidebar() : openSidebar(); });
    if (backdrop) backdrop.addEventListener('click', closeSidebar);

    init();
  </script>
</body>
</html>
